import{j as s}from"./ui-vendor-CJq8dhki.js";import{c as S,h as v,r as c,L as k}from"./react-vendor-pL-Lea-m.js";import{u as C,t as T,o as L,s as h}from"./portal-B8QEegQl.js";import{_ as E,u as F,C as A,d as M,e as R,f as B,g as D,A as p,h as I,i as x,ai as O,L as u,I as b,a as $,n as q,$ as H}from"./admin-BnupzcLy.js";const J=L({new_password:h().min(8,{message:"Password must be at least 8 characters"}),confirm_password:h().min(8,{message:"Password must be at least 8 characters"})}).refine(e=>e.new_password===e.confirm_password,{message:"Passwords do not match",path:["confirm_password"]}),U=()=>{const{t:e}=E(),g=S(),{toast:j}=F(),[f]=v(),r=f.get("token"),[n,d]=c.useState(!1),[i,t]=c.useState("idle"),[P,a]=c.useState(""),{register:l,handleSubmit:N,formState:{errors:o}}=C({resolver:T(J)});c.useEffect(()=>{r||(a(e("resetPassword.noToken")),t("error"))},[r,e]);const _=async y=>{if(!r){a(e("resetPassword.noToken"));return}d(!0),t("idle"),a("");try{const w=await(await fetch("/api/password-reset-confirm.php",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:r,new_password:y.new_password})})).json();w.success?(t("success"),j({title:e("resetPassword.success"),description:e("resetPassword.successMessage")}),setTimeout(()=>{g("/member-login")},3e3)):(t("error"),a(w.message||e("resetPassword.error")))}catch(m){console.error("Reset password error:",m),t("error"),a(e("resetPassword.networkError"))}finally{d(!1)}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-deep-purple via-black to-electric-blue pt-20 flex items-center justify-center",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs(A,{className:"max-w-md mx-auto bg-black/50 backdrop-blur-md border-white/10",children:[s.jsxs(M,{className:"text-center",children:[s.jsx(R,{className:"text-3xl font-bold text-white mb-2",children:e("resetPassword.title")}),s.jsx(B,{className:"text-white/70 text-lg",children:e("resetPassword.subtitle")})]}),s.jsxs(D,{className:"space-y-6",children:[i==="success"&&s.jsxs(p,{className:"border-green-500/50 bg-green-500/10",children:[s.jsx(I,{className:"h-4 w-4 text-green-400"}),s.jsx(x,{className:"text-green-400",children:e("resetPassword.successMessage")})]}),i==="error"&&s.jsxs(p,{variant:"destructive",children:[s.jsx(O,{className:"h-4 w-4"}),s.jsx(x,{children:P})]}),i!=="success"&&r&&s.jsxs("form",{onSubmit:N(_),className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(u,{htmlFor:"new_password",className:"text-white",children:[e("resetPassword.newPassword")," *"]}),s.jsx(b,{id:"new_password",type:"password",...l("new_password"),className:"bg-white/10 border-white/20 text-white placeholder:text-white/50",placeholder:e("resetPassword.newPasswordPlaceholder")}),o.new_password&&s.jsx("p",{className:"text-red-400 text-sm",children:o.new_password.message}),s.jsx("p",{className:"text-white/50 text-xs",children:e("resetPassword.passwordRequirement")})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(u,{htmlFor:"confirm_password",className:"text-white",children:[e("resetPassword.confirmPassword")," *"]}),s.jsx(b,{id:"confirm_password",type:"password",...l("confirm_password"),className:"bg-white/10 border-white/20 text-white placeholder:text-white/50",placeholder:e("resetPassword.confirmPasswordPlaceholder")}),o.confirm_password&&s.jsx("p",{className:"text-red-400 text-sm",children:o.confirm_password.message})]}),s.jsx($,{type:"submit",className:"w-full bg-electric-blue hover:bg-electric-blue/80 text-deep-purple",disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx(q,{className:"mr-2 h-4 w-4 animate-spin"}),e("common.loading")]}):s.jsxs(s.Fragment,{children:[s.jsx(H,{className:"mr-2 h-4 w-4"}),e("resetPassword.submitButton")]})})]}),s.jsx("div",{className:"text-center text-white/70 text-sm",children:s.jsx("p",{children:s.jsx(k,{to:"/member-login",className:"text-electric-blue hover:underline",children:e("resetPassword.backToLogin")})})})]})]})})})};export{U as default};
